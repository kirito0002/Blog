# 闭包

+ ## 闭包

+ 条件

  + 执行上下文(代号A)
  + 在执行上下文中**创建的函数(代号B)**
  + 注意当B(函数)执行时，如果**访问了A中变量对象中的值**，就会产生闭包

+ 闭包是由**函数**和**其相关的引用环境**组合而成的**实体**

+ 闭包是**词法作用域**中的**函数**和其**相关变量**的**包裹体**


![1552274325918](https://i.imgur.com/rlO4Via.png)

+ ## 闭包与作用域链

  + 作用域规则在代码编译阶段确定，即在代码书写之后作用域链就已经确定，所有闭包不会影响作用域
    + 作用域链在代码执行时生成
    + 变量查找按照作用域链**由内到外**的顺序(遵循词法作用域)，直到完成查找，若未查询到则报错
  + 调用栈在代码执行时确定，作用是**处理和追踪**函数的调用

+ ## 垃圾回收机制

  + 执行上下文
    + 函数每调用一次，就会创建一个新的执行上下文
    + 函数执行结束，相应的执行上下文销毁
  + 闭包：使函数中的变量被保存在内存中不被释放